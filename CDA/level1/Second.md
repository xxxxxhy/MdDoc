# 第二章 表格结构数据与表结构数据


    结构化数据指数据结构规范、完整的数据，主要产生于企业的业务系统及客户端应用程序。

> 交易记录、产品信息、库存信息等

    非结构化数据是指数据结构不规范、不完整、格式多样、难以理解、难以进行标准化处理的数据。来自企业系统之外的数据，大部分都属于非结构化数据。

> 聊天记录，网站图片、视频等


---

## 1. **表格结构数据特征**

## 表格结构数据概念

    表格结构数据是指应用在电子表格工具上的数据。表格结构数据需要用电子表格工具对其进行处理加工、分析及展现。

## 表格结构数据处理工具

    主流的有微软公司的Excel、苹果公司的Numbers及金山办公的WPS表格

## 表格结构数据特征

    1. 表格结构数据层级

        单元格 -> 单元格区域 -> 工作表 -> 工作簿

![](../../MdImages/CDA/Second/TableStructureHierarchy.png)

        父级->子级：一个父级对象下包含多个不同子级对象

        子级->父级：一个子级对象只能属于某一个特定的父级对象

    2. 表格结构数据的数据类型
        
        在表格结构数据中可以为不同的单元格设置不同的数据类型，但是一次只能为一个单元格设置一种数据类型。

        数值型：数值型中包含整数值和小数值的信息，主要用来进行数学计算。

        文本型：文本值中包含文字、符号、数字等信息，主要用来对文本内容进行描述时使用。

        逻辑型：逻辑值中只包含真值与假值两种信息，主要用来进行逻辑判断。

    3. 单元格的格式属性

        一个单元格不仅具有数据类型的属性，还具有单元格格式的属性。主要有数字格式和显示格式两种。

> *数据类型的属性是为了让计算机能够更加准确、高效地对数据进行识别、处理、计算而存在的*

> *单元格格式的属性就是为了让用户能够更加清晰、直观地理解数据信息而存在的*

        数字格式：决定显示形式。（数字、百分比、货币和日期）（需注意表结构数据中，日期类型不是数字格式而是数据类型）

        显示格式：决定显示效果。（字体（自行、颜色）、单元格填充色、图标集、显示位置）。

--- 

## 2. **表格数据获取、引用、查询与计算**

## 表格结构数据获取方法

    1. 企业的后台数据库系统
![](../../MdImages/CDA/Second/BackDataGetData.png)

        后台数据库系统获取数据的流程和分析人员向数据库管理人员提需求时的要求。
![](../../MdImages/CDA/Second/BackDataGetProcess.png)

    2. 企业的前端操作平台

![](../../MdImages/CDA/Second/FrontEndPlatformGetData.png)

    3. 企业外部渠道

![](../../MdImages/CDA/Second/ExternalSourceGetData.png)

    不论从哪种渠道获取到的数据，最终都要以电子表格工具支持的数据文件的形式使用，常见的电子表格工具支持的数据文件主要有以下两种形式：

    1. 文本文件

        存储数据信息的文本文件主要有两种，分别是.csv和.txt文件。
![](../../MdImages/CDA/Second/TextFileForm.png)

    2. 电子表格工具文件

        每种电子表格工具都有自己软件专有的默认文件。WPS表格的默认文件是.et格式文件，Excel的默认文件是.xlsx文件，而苹果Numbers的默认文件是.numbers格式文件。

## 单元格区域的特征

    1. 单元格区域需由连续的单元格构成。
    2. 单元格区域须是一个方形区域。


## 表格结构数据的引用方法

    1. 单元格值的引用方法

![](../../MdImages/CDA/Second/CellValueRefeMeth.png)

    2. 单元格区域值的引用方法

![](../../MdImages/CDA/Second/CellRangeValueRefeMeth.png)

## 表格结构数据的查询方法

    1. 使用表格工具搜索功能进行查询（ctrl+f）

![](../../MdImages/CDA/Second/SearchToolQueries.png)

    2. 使用查询函数进行查询

![](../../MdImages/CDA/Second/QueryFunctionQueries.png)

    函数主要由五部分构成

![](../../MdImages/CDA/Second/Function.png)

### *表格数据结构的计算方法*

    1. 直接计算
![](../../MdImages/CDA/Second/DirectCalculation.png)

    2. 函数计算


## 表格结构数据的常用函数

![](../../MdImages/CDA/Second/FunctionCompute.png)


---

## 3. **表结构数据特征**

    表结构数据的主要来源是数据库中的数据表。一个数据表有一个表名，表名的作用是区分不同的数据表。一个数据表由多列不同“字段“及多行不同“记录”构成。

![](../../MdImages/CDA/Second/TableStructureData.png)

## 维度及度量的意义
    
    以电商平台记录的用户购买信息为例：

    每一行“记录”记录的是与此次交易相关的各种信息，主要分为两类：
    1. 一类是用来描述交易行为不同角度的信息，称之为“维度”，
    2. 另一类是描述交易结果的信息，称为“度量”。

    表结构数据中的维度字段一般是文本型字段，而度量字段一般是数值型字段。

![](../../MdImages/CDA/Second/FactAndDimensionTables.png)

### 维度表

    只包含维度信息而不包含度量信息的表称为维度表，例如：产品表、客户信息表、学员信息表等字段。表中的字段不涉及任何业务行为产生的结果，只单纯统计及列举所属维度的各种不同属性内容。
    作用：用来扩展观测业务问题的角度及细节。

### 事实表

    既包含维度信息又包含度量信息，例如，订单表，采购进货单明细表、库存表等。
    作用：记录业务的实际情况，在业务描述性分析中，用事实表中的度量字段对业务行为产生结果的好坏程度进行描述。

## 表结构数据特征

    1. 第一个特征是表结构数据中的基本引用、操作、计算单位是字段或记录行。因此在表结构数据中，一次引用、操作及计算过程都至少要对一整列或一整行数据产生影响。表结构数据中很难对某一个特定单元格值进行单独的处理与分析。
![](../../MdImages/CDA/Second/TableStructureDataCharacteristics1.png)
> 字段的第一行叫做字段名，同一个表中不能出现2个以上有相同字段名的字段。

![](../../MdImages/CDA/Second/TableStructureDataCharacteristics2.png) 
    2. 第二个特征是在表中所有字段的记录行数相同。与单元格区域的特征类似，一个数据表中的数据也需要是连续的呈方形结构分布。

    3. 第三个特征是，几乎所有数据表中都存在且只存在一个主键。

## 缺失值

    表结构为了构成一个连续、完整的方形结构，就必须满足每个字段的记录行数相同的条件。若在表结数据中确实存在没有明确数值的记录，那么该处的记录中使用的是空值。空值在计算机中使用null表示，在数据分析工作中，将空值称为缺失值。

**处理缺失值**

    1. 当缺失值出现在文本型字段中且对分析结果影响不大是，可以选择不进行处理或这也可以用其他没有实际业务含义的文本字符对缺失值进行替换。

    2. 当缺失值出现在文本型字段且对分析结果产生重要影响时，一般分析人员只能通过与缺失值记录行信息录入者进行确认的方法对缺失值进行替换处理。若信息录入者也无法确定缺失值的有效信息，此行记录内容很可能是一行无效或者错误的数据记录，可将此行记录内容删除。

    3.当缺失值出现在数值型字段中时，需要综合考虑该数值型字段所代表的的度量意义，以及针对该数值型字段进行汇总计算的方式，来最终决定对缺失值的具体处理方法。

## 主键的意义

    一个好的数据库环境要按照“范式规范”进行设计，而范式规范中的第二范式要求数据表中的每行记录必须可以被唯一区分，用来区分每行记录使用的字段或字段组合就是主键。

    1. 物理意义

![](../../MdImages/CDA/Second/PhysicalMeaning.png)

    2. 业务意义： 主键是表的业务记录单位。数据表中的所有非主键字段都要围绕主键字段展开，只有能够扩充及描述主键信息的字段才能出现在同一个表中。

![](../../MdImages/CDA/Second/BusinessSignificance.png)

**确定主键的方法**

![](../../MdImages/CDA/Second/DetermineThePrimaryKey.png)

## 表结构数据与表格结构数据差异

---

## 4. **表结构数据获取、加工与使用**

## 表结构数据获取渠道及方法

    

## 表结构数据连接逻辑

## 表结构数据汇总逻辑

## ETL作用、特征

## 应用E-R图

## 计算两表连接汇总值

## 应用ETL获取及处理数据


